{% load static %}

<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Social Media</title>

<script src="https://kit.fontawesome.com/cb792c0850.js" crossorigin="anonymous"></script>

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
body{
background: linear-gradient(135deg,#eef2ff,#fdf2f8,#ecfeff);
min-height:100vh;
transition:0.3s;
font-family: 'Segoe UI', sans-serif;
}

/* ðŸŒ™ DARK MODE */
.dark{
background:#0f172a !important;
color:white;
}
.dark .sidebar{background:#020617;color:white;}
.dark .post-card{background:#020617;color:white;border:1px solid #222;}
.dark a{color:white;}
.dark .text-muted{color:#aaa !important;}

/* sidebar */
.sidebar{
background:white;
height:100vh;
box-shadow:2px 0 15px rgba(0,0,0,0.05);
}

/* post */
.post-card{
background:white;
border-radius:18px;
padding:18px;
margin:50px 0;
box-shadow:0 10px 30px rgba(0,0,0,0.08);
transition:0.3s;
}
.post-card:hover{
transform:translateY(-5px);
box-shadow:0 20px 40px rgba(0,0,0,0.12);
}

/* profile */
.profile-pic{
width:70px;
height:70px;
border-radius:50%;
object-fit:cover;
border:3px solid #fff;
box-shadow:0 4px 12px rgba(0,0,0,0.2);
}

/* image */
.post-img{
width:100%;
height:450px;
object-fit:cover;
border-radius:15px;
margin-bottom:12px;
cursor:pointer;
transition:0.3s;
}
.post-img:hover{
transform:scale(1.03);
}

/* IMAGE POPUP */
#imgPopup{
display:none;
position:fixed;
z-index:9999;
top:0;
left:0;
width:100%;
height:100%;
background:rgba(0,0,0,0.85);
justify-content:center;
align-items:center;
}
#imgPopup img{
max-width:90%;
max-height:90%;
border-radius:15px;
animation:zoom .3s ease;
}
@keyframes zoom{
from{transform:scale(0.7);}
to{transform:scale(1);}
}
</style>

</head>

<body>

<!-- ðŸŒ™ DARK BUTTON -->

<button onclick="toggleDark()" 
style="position:fixed;top:20px;right:25px;z-index:999;"
class="btn btn-dark">
ðŸŒ™ Dark </button>

<!-- IMAGE POPUP -->

<div id="imgPopup" onclick="closeImg()">
<img id="popupImg">
</div>

<div class="container-fluid">
<div class="row">

<!-- SIDEBAR -->

<nav class="col-md-2 d-none d-md-block sidebar" style="position:fixed;">
<div class="text-center mt-4">
<img src="{{profile.profileimg.url}}" class="profile-pic">
<h4 class="mt-3">
<a href="/profile/{{user}}" style="text-decoration:none;color:black;">@{{user}}</a>
</h4>
</div>

<ul class="nav flex-column mt-5">

<li class="nav-item">
<a class="nav-link active" href="{% url 'home' %}">
<i class="fa-solid fa-house"></i> Home
</a>
</li>

<li class="nav-item">
<a class="nav-link" href="{% url 'explore' %}">
<i class="fa-solid fa-compass"></i> Explore
</a>
</li>

<li class="nav-item">
<a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#exampleModal3">
<i class="fa-solid fa-magnifying-glass"></i> Search
</a>
</li>

<li class="nav-item">
<a class="nav-link" href="#" data-bs-toggle="modal" data-bs-target="#exampleModal">
<i class="fa-solid fa-circle-plus"></i> Create Post
</a>
</li>

<li class="nav-item">
<a class="nav-link" href="{% url 'profile' request.user.username %}">
<i class="fa-solid fa-user"></i> Profile
</a>
</li>

<li class="nav-item">
<a class="nav-link text-danger" href="{% url 'logout' %}">
<i class="fa-solid fa-right-from-bracket"></i> Logout
</a>
</li>

</ul>
</nav>

<!-- MAIN -->

<main class="col-md-9 ml-sm-auto col-lg-10 px-md-4" style="margin-left:230px;">

{% include "modal.html" %}
{% include "search.html" %}

<div>
{% for post in posts %}
<div class="container" id="post{{post.id}}">
<div class="row">
<div class="col-md-6 mx-auto">
<div class="post-card">

{% if post.image %} <img src="{{post.image.url}}" class="post-img" onclick="openImg(this.src)">
{% endif %}

<h5>
<a href="/profile/{{post.user}}" style="text-decoration:none;">
@{{post.user}}
</a>
</h5>

<p>{{post.caption}}</p>
<p class="text-muted">{{post.created_at}}</p>

<hr>

<div class="d-flex justify-content-between align-items-center">

<div style="font-size:24px;display:flex;gap:25px;">

<!-- LIKE -->
{% comment %} <a href="{% url 'like-post' post.id %}">
{% if post.liked %}
<i class="fa-solid fa-heart" style="color:red;"></i>
{% else %}
<i class="fa-regular fa-heart"></i>
{% endif %}
</a> {% endcomment %}
<a href="/like-post/{{post.id}}">
    {% if post.liked %}
        <i class="fa-solid fa-heart" style="color:red;"></i>
    {% else %}
        <i class="fa-regular fa-heart"></i>
    {% endif %}
</a>



<i class="fa-regular fa-comment"></i> <i class="fa-solid fa-paper-plane"></i>

</div>

<!-- ðŸ”¥ LIKE COUNT SIMPLE -->

<div>
<b>{{post.no_of_likes}} likes</b>
</div>

</div>
</div>

</div>
</div>
</div>
{% endfor %}
</div>

</main>
</div>
</div>

<script>
function toggleDark(){
document.body.classList.toggle("dark")
}

/* IMAGE POPUP */
function openImg(src){
document.getElementById("imgPopup").style.display="flex";
document.getElementById("popupImg").src=src;
}
function closeImg(){
document.getElementById("imgPopup").style.display="none";
}
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>



</body>
</html>
